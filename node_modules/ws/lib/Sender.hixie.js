function e(e){this.socket=e,this.continuationFrame=!1,this.isClosed=!1}var t=require("events"),r=require("util"),n=t.EventEmitter;module.exports=e,r.inherits(e,t.EventEmitter),e.prototype.send=function(r,e,u){if(!this.isClosed){var c="string"==typeof r,o=c?Buffer.byteLength(r):r.length,s=o>127?2:1,i=0==this.continuationFrame,a=!e||!(void 0!==e.fin&&!e.fin),t=new Buffer((i?e&&e.binary?1+s:1:0)+o+(!a||e&&e.binary?0:1)),n=i?1:0;i&&(e&&e.binary?(t.write("","binary"),s>1&&t.write(String.fromCharCode(128+o/128),n++,"binary"),t.write(String.fromCharCode(127&o),n++,"binary")):t.write("\x00","binary")),c?t.write(r,n,"utf8"):r.copy(t,n,0),a?(e&&e.binary||t.write("ÿ",n+o,"binary"),this.continuationFrame=!1):this.continuationFrame=!0;try{this.socket.write(t,"binary",u)}catch(l){this.error(""+l)}}},e.prototype.close=function(r,n,o,e){if(!this.isClosed){this.isClosed=!0;try{this.continuationFrame&&this.socket.write(new Buffer([255],"binary")),this.socket.write(new Buffer([255,0]),"binary",e)}catch(t){this.error(""+t)}}},e.prototype.ping=function(){},e.prototype.pong=function(){},e.prototype.error=function(e){return this.emit("error",e),this};