module.exports=function(){function e(r){return{}.toString.call(r).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function s(n){var a,t,s=o.dirname(r.realpathSync(n)),e={};try{a=r.readFileSync(n),t=JSON.parse(a),e=t.configuration||{},e.version=t.version}catch(i){console.log("node-options::readPackageconfig("+n+")|exception=",i)}return e.rootPath=s,e}function u(r){var n,o;r=r||{};for(n in r)o=n.toUpperCase(),"undefined"!==e(process.env[o])&&(r[n]=process.env[o]);return r}function f(e,o,i){var a,s=t(e,i);return s&&r.existsSync(s)?(a=JSON.parse(r.readFileSync(s)),o=n(a,o)):(e=o.rootPath+"/"+e,e&&r.existsSync(e)&&(a=JSON.parse(r.readFileSync(e)),o=n(a,o))),o}function t(e,t){if(!e||"/"===e.charAt(0))return e;var n=o.join(process.cwd(),e);return r.existsSync(n)?n:(n=o.join(process.env.HOME,t?t:"",e),r.existsSync(n)?n:e)}function n(r,n){for(var e in r)r.hasOwnProperty(e)&&(n[e]=r[e]);return n}function l(r){var t,o;r=n(r,{name:process.argv[1]}),t="USAGE: "+r.name;for(o in r)t+=" --"+o,"object"===e(r[o])||"array"===e(r[o])?t+="="+JSON.stringify(r[o]):"string"!==e(r[o])&&"number"!==e(r[o])||(t+="="+r[o]);return t}function i(r){var e='       UNKNOWN ARGUMENTS: "'+(r?r.join('", "'):"")+'"';return e}function c(s,r){var n=null,o=[],t=null;return s.forEach(function(i){var s,c;if(n)n.push(i);else if(t)t.push(i);else if("--"===i)t=[];else if(s=i.match(a),null!==s&&3===s.length&&void 0!==s[1]&&r.hasOwnProperty(s[1]))if(o.length>0)n=o,o=[];else if(void 0!==s[2])if(c=e(r[s[1]]),"object"===c||"array"===c)try{r[s[1]]=JSON.parse(s[2])}catch(u){n=[i+"* parse error"]}else r[s[1]]=s[2];else r[s[1]]=!r[s[1]];else o.push(i)}),{errors:n,args:o,end:t}}var o=require("path"),r=require("fs"),a=/^--(\s*[^=\s]+)(?:\s*=(.*))?$/;return{parse:c,mergeEnvironment:u,overlayConfig:f,readPackageConfig:s,usage:l,error:i,merge:n,isType:e}}();