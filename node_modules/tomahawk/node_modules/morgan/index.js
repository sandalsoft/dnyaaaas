function r(e){e=e.replace(/"/g,'\\"');var r='  return "'+e.replace(/:([-\w]{2,})(?:\[([^\]]+)\])?/g,function(t,e,r){return'"\n    + (tokens["'+e+'"](req, res, "'+r+'") || "-") + "'})+'";';return Function("tokens, req, res",r)}var t=require("basic-auth"),i=require("bytes"),e=require("depd")("morgan"),n=require("finished"),o=1e3;exports=module.exports=function(t,i){var d,f,s,u,l,p,a,c,m,g;return"object"==typeof t&&(i=t,t=i.format||"default",e("morgan(options): use morgan("+("string"==typeof t?JSON.stringify(t):"format")+", options) instead")),void 0===t&&e("undefined format: specify a format"),i=i||{},d=i.immediate,f=i.skip||function(){return!1},s=exports[t]||t||exports.default,"function"!=typeof s&&(s=r(s)),u=i.stream||process.stdout,l=i.buffer,l&&(p=u,a=[],c=null,m="number"==typeof l?l:o,g=function(){c=null,a.length&&(p.write(a.join("")),a.length=0)},u={write:function(e){null===c&&(c=setTimeout(g,m)),a.push(e)}}),function(e,r,o){function t(){if(!f(e,r)){var t=s(exports,e,r);null!=t&&u.write(t+"\n")}}e._startAt=process.hrtime(),e._startTime=new Date,e._remoteAddress=e.connection&&e.connection.remoteAddress,d?t():n(r,t),o()}},exports.token=function(e,r){return exports[e]=r,this},exports.format=function(e,r){return exports[e]=r,this},exports.format("combined",':remote-addr - :remote-user [:date] ":method :url HTTP/:http-version" :status :res[content-length] ":referrer" ":user-agent"'),exports.format("common",':remote-addr - :remote-user [:date] ":method :url HTTP/:http-version" :status :res[content-length]'),exports.format("default",':remote-addr - :remote-user [:date] ":method :url HTTP/:http-version" :status :res[content-length] ":referrer" ":user-agent"'),e.property(exports,"default","default format: use combined format"),exports.format("short",":remote-addr :remote-user :method :url HTTP/:http-version :status :res[content-length] - :response-time ms"),exports.format("tiny",":method :url :status :res[content-length] - :response-time ms"),exports.format("dev",function(o,i,n){var a,e=32,t=n.statusCode;return t>=500?e=31:t>=400?e=33:t>=300&&(e=36),(a=r("[0m:method :url ["+e+"m:status [0m:response-time ms - :res[content-length][0m"))(o,i,n)}),exports.token("url",function(e){return e.originalUrl||e.url}),exports.token("method",function(e){return e.method}),exports.token("response-time",function(r,n){var e,t;return n._header&&r._startAt?(e=process.hrtime(r._startAt),t=1e3*e[0]+1e-6*e[1],t.toFixed(3)):""}),exports.token("date",function(){return(new Date).toUTCString()}),exports.token("status",function(r,e){return e._header?e.statusCode:null}),exports.token("referrer",function(e){return e.headers.referer||e.headers.referrer}),exports.token("remote-addr",function(e){return e.ip?e.ip:e._remoteAddress?e._remoteAddress:e.connection?e.connection.remoteAddress:void 0}),exports.token("remote-user",function(r){var e=t(r),n=e&&e.name||"-";return n}),exports.token("http-version",function(e){return e.httpVersionMajor+"."+e.httpVersionMinor}),exports.token("user-agent",function(e){return e.headers["user-agent"]}),exports.token("req",function(e,t,r){return e.headers[r.toLowerCase()]}),exports.token("res",function(t,e,r){return(e._headers||{})[r.toLowerCase()]});