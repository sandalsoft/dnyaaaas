function e(e){return t.createHash("sha1").update(e).digest("hex")}var t=require("crypto");exports.sign=function(e,r){if("string"!=typeof e)throw new TypeError("cookie required");if("string"!=typeof r)throw new TypeError("secret required");return e+"."+t.createHmac("sha256",r).update(e).digest("base64").replace(/\=+$/,"")},exports.unsign=function(t,r){if("string"!=typeof t)throw new TypeError("cookie required");if("string"!=typeof r)throw new TypeError("secret required");var n=t.slice(0,t.lastIndexOf(".")),o=exports.sign(n,r);return e(o)==e(t)?n:!1};