(function(){var n,e,t,o,r,i,a,s;e={},s=this,"undefined"!=typeof module&&null!==module&&module.exports?module.exports=e:s.ipaddr=e,a=function(n,o,i,r){var t,e;if(n.length!==o.length)throw Error("ipaddr: cannot match CIDR for objects with different lengths");for(t=0;r>0;){if(e=i-r,0>e&&(e=0),n[t]>>e!==o[t]>>e)return!1;r-=i,t+=1}return!0},e.subnetMatch=function(o,i,r){var n,e,a,t,s;null==r&&(r="unicast");for(n in i)for(e=i[n],"[object Array]"!==toString.call(e[0])&&(e=[e]),t=0,s=e.length;s>t;t++)if(a=e[t],o.match.apply(o,a))return n;return r},e.IPv4=function(){function t(e){var r,t,n;if(4!==e.length)throw Error("ipaddr: ipv4 octet count should be 4");for(t=0,n=e.length;n>t;t++)if(r=e[t],!(r>=0&&255>=r))throw Error("ipaddr: ipv4 octet is a byte");this.octets=e}return t.prototype.kind=function(){return"ipv4"},t.prototype.toString=function(){return this.octets.join(".")},t.prototype.toByteArray=function(){return this.octets.slice(0)},t.prototype.match=function(e,t){if("ipv4"!==e.kind())throw Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return a(this.octets,e.octets,8,t)},t.prototype.SpecialRanges={broadcast:[[new t([255,255,255,255]),32]],multicast:[[new t([224,0,0,0]),4]],linkLocal:[[new t([169,254,0,0]),16]],loopback:[[new t([127,0,0,0]),8]],"private":[[new t([10,0,0,0]),8],[new t([172,16,0,0]),12],[new t([192,168,0,0]),16]],reserved:[[new t([192,0,0,0]),24],[new t([192,0,2,0]),24],[new t([192,88,99,0]),24],[new t([198,51,100,0]),24],[new t([203,0,113,0]),24],[new t([240,0,0,0]),4]]},t.prototype.range=function(){return e.subnetMatch(this,this.SpecialRanges)},t.prototype.toIPv4MappedAddress=function(){return e.IPv6.parse("::ffff:"+this)},t}(),t="(0?\\d+|0x[a-f0-9]+)",o={fourOctet:RegExp("^"+t+"\\."+t+"\\."+t+"\\."+t+"$","i"),longValue:RegExp("^"+t+"$","i")},e.IPv4.parser=function(n){var e,t,i,r,a;return t=function(e){return"0"===e[0]&&"x"!==e[1]?parseInt(e,8):parseInt(e)},(e=n.match(o.fourOctet))?function(){var r,a,n,o;for(n=e.slice(1,6),o=[],r=0,a=n.length;a>r;r++)i=n[r],o.push(t(i));return o}():(e=n.match(o.longValue))?(a=t(e[1]),function(){var e,t;for(t=[],r=e=0;24>=e;r=e+=8)t.push(a>>r&255);return t}().reverse()):null},e.IPv6=function(){function t(e){var r,t,n;if(8!==e.length)throw Error("ipaddr: ipv6 part count should be 8");for(t=0,n=e.length;n>t;t++)if(r=e[t],!(r>=0&&65535>=r))throw Error("ipaddr: ipv6 part should fit to two octets");this.parts=e}return t.prototype.kind=function(){return"ipv6"},t.prototype.toString=function(){var o,e,t,r,i,n,a;for(i=function(){var t,o,r,n;for(r=this.parts,n=[],t=0,o=r.length;o>t;t++)e=r[t],n.push(e.toString(16));return n}.call(this),o=[],t=function(e){return o.push(e)},r=0,n=0,a=i.length;a>n;n++)switch(e=i[n],r){case 0:t("0"===e?"":e),r=1;break;case 1:"0"===e?r=2:t(e);break;case 2:"0"!==e&&(t(""),t(e),r=3);break;case 3:t(e)}return 2===r&&(t(""),t("")),o.join(":")},t.prototype.toByteArray=function(){var e,r,t,o,n;for(e=[],n=this.parts,t=0,o=n.length;o>t;t++)r=n[t],e.push(r>>8),e.push(255&r);return e},t.prototype.toNormalizedString=function(){var e;return function(){var t,o,r,n;for(r=this.parts,n=[],t=0,o=r.length;o>t;t++)e=r[t],n.push(e.toString(16));return n}.call(this).join(":")},t.prototype.match=function(e,t){if("ipv6"!==e.kind())throw Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return a(this.parts,e.parts,16,t)},t.prototype.SpecialRanges={unspecified:[new t([0,0,0,0,0,0,0,0]),128],linkLocal:[new t([65152,0,0,0,0,0,0,0]),10],multicast:[new t([65280,0,0,0,0,0,0,0]),8],loopback:[new t([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new t([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new t([0,0,0,0,0,65535,0,0]),96],rfc6145:[new t([0,0,0,0,65535,0,0,0]),96],rfc6052:[new t([100,65435,0,0,0,0,0,0]),96],"6to4":[new t([8194,0,0,0,0,0,0,0]),16],teredo:[new t([8193,0,0,0,0,0,0,0]),32],reserved:[[new t([8193,3512,0,0,0,0,0,0]),32]]},t.prototype.range=function(){return e.subnetMatch(this,this.SpecialRanges)},t.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},t.prototype.toIPv4Address=function(){var t,r,n;if(!this.isIPv4MappedAddress())throw Error("ipaddr: trying to convert a generic ipv6 address to ipv4");return n=this.parts.slice(-2),t=n[0],r=n[1],new e.IPv4([t>>8,255&t,r>>8,255&r])},t}(),r="(?:[0-9a-f]+::?)+",i={"native":RegExp("^(::)?("+r+")?([0-9a-f]+)?(::)?$","i"),transitional:RegExp("^((?:"+r+")|(?:::)(?:"+r+")?)"+(""+t+"\\."+t+"\\."+t+"\\."+t+"$"),"i")},n=function(e,a){var t,r,o,n,i;if(e.indexOf("::")!==e.lastIndexOf("::"))return null;for(t=0,r=-1;(r=e.indexOf(":",r+1))>=0;)t++;for(":"===e[0]&&t--,":"===e[e.length-1]&&t--,i=a-t,n=":";i--;)n+="0:";return e=e.replace("::",n),":"===e[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),function(){var t,i,r,n;for(r=e.split(":"),n=[],t=0,i=r.length;i>t;t++)o=r[t],n.push(parseInt(o,16));return n}()},e.IPv6.parser=function(r){var e,t;return r.match(i.native)?n(r,8):(e=r.match(i.transitional))&&(t=n(e[1].slice(0,-1),6))?(t.push(parseInt(e[2])<<8|parseInt(e[3])),t.push(parseInt(e[4])<<8|parseInt(e[5])),t):null},e.IPv4.isIPv4=e.IPv6.isIPv6=function(e){return null!==this.parser(e)},e.IPv4.isValid=e.IPv6.isValid=function(e){var t;try{return new this(this.parser(e)),!0}catch(r){return t=r,!1}},e.IPv4.parse=e.IPv6.parse=function(t){var e;if(e=this.parser(t),null===e)throw Error("ipaddr: string is not formatted like ip address");return new this(e)},e.isValid=function(t){return e.IPv6.isValid(t)||e.IPv4.isValid(t)},e.parse=function(t){if(e.IPv6.isIPv6(t))return e.IPv6.parse(t);if(e.IPv4.isIPv4(t))return e.IPv4.parse(t);throw Error("ipaddr: the address has neither IPv6 nor IPv4 format")},e.process=function(t){var e;return e=this.parse(t),"ipv6"===e.kind()&&e.isIPv4MappedAddress()?e.toIPv4Address():e}}).call(this);