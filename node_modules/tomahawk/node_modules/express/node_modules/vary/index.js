function e(i,n){var r,e,a,o,s;if(!i||!i.getHeader||!i.setHeader)throw new TypeError("res argument is required");if(!n)throw new TypeError("field argument is required");for(r=Array.isArray(n)?n:[n+""],e=0;e<r.length;e++)if(t.test(r[e]))throw new TypeError("field argument contains an invalid header");if(a=i.getHeader("Vary")||"",o=Array.isArray(a)?a.join(", "):a+"","*"!==o){if(s=o.toLowerCase().split(/ *, */),-1!==r.indexOf("*")||-1!==s.indexOf("*"))return void i.setHeader("Vary","*");for(e=0;e<r.length;e++)n=r[e].toLowerCase(),-1===s.indexOf(n)&&(s.push(n),o=o?o+", "+r[e]:r[e]);i.setHeader("Vary",o)}}module.exports=e;var t=/[\(\)<>@,;:\\"\/\[\]\?=\{\}\u0020\u0009]/;