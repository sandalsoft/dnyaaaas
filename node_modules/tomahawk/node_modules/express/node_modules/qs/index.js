function u(e,t){var r,n;if(0==e[t].length)return e[t]={};r={};for(n in e[t])a.call(e[t],n)&&(r[n]=e[t][n]);return e[t]=r,r}function s(p,i,n,c){var a,l=p.shift();Object.getOwnPropertyDescriptor(Object.prototype,n)||(l?(a=i[n]=i[n]||[],"]"==l?e(a)?""!=c&&a.push(c):"object"==typeof a?a[o(a).length]=c:a=i[n]=[i[n],c]:~t(l,"]")?(l=l.substr(0,l.length-1),!r.test(l)&&e(a)&&(a=u(i,n)),s(p,a,l,c)):(!r.test(l)&&e(a)&&(a=u(i,n)),s(p,a,l,c))):e(i[n])?i[n].push(c):"object"==typeof i[n]?i[n]=c:void 0===i[n]?i[n]=c:i[n]=[i[n],c])}function l(n,o,u){var i,l,p,a,c;if(~t(o,"]"))i=o.split("["),l=i.length,p=l-1,s(i,n,"base",u);else{if(!r.test(o)&&e(n.base)){a={};for(c in n.base)a[c]=n.base[c];n.base=a}f(n.base,o,u)}return n}function n(t){var r,o,i;if("object"!=typeof t)return t;if(e(t)){r=[];for(o in t)a.call(t,o)&&r.push(t[o]);return r}for(i in t)t[i]=n(t[i]);return t}function y(e){var t={base:{}};return v(o(e),function(r){l(t,r,e[r])}),n(t.base)}function g(e){var r=b((e+"").split("&"),function(o,e){var i=t(e,"="),s=x(e),n=e.substr(0,s||i),r=e.substr(s||i,e.length),r=r.substr(t(r,"=")+1,r.length);return""==n&&(n=e,r=""),""==n?o:l(o,p(n),p(r))},{base:{}}).base;return n(r)}function m(t,e){if(!e)throw new TypeError("stringify expects an object");return e+"="+encodeURIComponent(t)}function d(t,r){var e,n=[];if(!r)throw new TypeError("stringify expects an object");for(e=0;e<t.length;e++)n.push(i(t[e],r+"["+e+"]"));return n.join("&")}function h(r,s){var e,t,a,n=[],c=o(r);for(t=0,a=c.length;a>t;++t)e=c[t],""!=e&&(null==r[e]?n.push(encodeURIComponent(e)+"="):n.push(i(r[e],s?s+"["+encodeURIComponent(e)+"]":encodeURIComponent(e))));return n.join("&")}function f(n,t,o){var r=n[t];Object.getOwnPropertyDescriptor(Object.prototype,t)||(void 0===r?n[t]=o:e(r)?r.push(o):n[t]=[r,o])}function x(n){var r,t,e,o=n.length;for(e=0;o>e;++e)if(t=n[e],"]"==t&&(r=!1),"["==t&&(r=!0),"="==t&&!r)return e}function p(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}}var i,c=Object.prototype.toString,a=Object.prototype.hasOwnProperty,t="function"==typeof Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(t,r){for(var e=0;e<t.length;e++)if(t[e]===r)return e;return-1},e=Array.isArray||function(e){return"[object Array]"==c.call(e)},o=Object.keys||function(t){var e,r=[];for(e in t)t.hasOwnProperty(e)&&r.push(e);return r},v="function"==typeof Array.prototype.forEach?function(e,t){return e.forEach(t)}:function(t,r){for(var e=0;e<t.length;e++)r(t[e])},b=function(e,n,o){var t,r;if("function"==typeof e.reduce)return e.reduce(n,o);for(t=o,r=0;r<e.length;r++)t=n(t,e[r]);return t},r=/^[0-9]+$/;exports.parse=function(e){return null==e||""==e?{}:"object"==typeof e?y(e):g(e)},i=exports.stringify=function(t,r){return e(t)?d(t,r):"[object Object]"==c.call(t)?h(t,r):"string"==typeof t?m(t,r):r+"="+encodeURIComponent(t+"")};