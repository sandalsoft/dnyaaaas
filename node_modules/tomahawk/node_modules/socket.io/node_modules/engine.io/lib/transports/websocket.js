function e(e){t.call(this,e);var r=this;this.socket=e.websocket,this.socket.on("message",this.onData.bind(this)),this.socket.once("close",this.onClose.bind(this)),this.socket.on("error",this.onError.bind(this)),this.socket.on("headers",function(e){r.emit("headers",e)}),this.writable=!0}var t=require("../transport"),n=require("engine.io-parser"),r=require("debug")("engine:ws");module.exports=e,e.prototype.__proto__=t.prototype,e.prototype.name="websocket",e.prototype.handlesUpgrades=!0,e.prototype.supportsFraming=!0,e.prototype.onData=function(e){r('received "%s"',e),t.prototype.onData.call(this,e)},e.prototype.send=function(o){var t,s,e=this;for(t=0,s=o.length;s>t;t++)n.encodePacket(o[t],this.supportsBinary,function(t){r('writing "%s"',t),e.writable=!1,e.socket.send(t,function(t){return t?e.onError("write error",t.stack):(e.writable=!0,void e.emit("drain"))})})},e.prototype.doClose=function(e){r("closing"),this.socket.close(),e&&e()};