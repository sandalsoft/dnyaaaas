function e(e){t.call(this,e),this.head="___eio["+(e._query.j||"").replace(/[^0-9]/g,"")+"](",this.foot=");"}var t=require("./polling"),r=require("querystring"),n=/\\\\n/g,o=/(\\)?\\n/g;module.exports=e,e.prototype.__proto__=t.prototype,e.prototype.onData=function(e){e=r.parse(e).d,"string"==typeof e&&(e=e.replace(o,function(e,t){return t?e:"\n"}),t.prototype.onData.call(this,e.replace(n,"\\n")))},e.prototype.doWrite=function(e){var r,t,n=JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029");e=this.head+n+this.foot,r={"Content-Type":"text/javascript; charset=UTF-8","Content-Length":Buffer.byteLength(e)},t=this.req.headers["user-agent"],t&&(~t.indexOf(";MSIE")||~t.indexOf("Trident/"))&&(r["X-XSS-Protection"]="0"),this.res.writeHead(200,this.headers(this.req,r)),this.res.end(e)},e.prototype.headers=function(t,e){return e=e||{},/MSIE 8\.0/.test(t.headers["user-agent"])&&(e["X-XSS-Protection"]="0"),this.emit("headers",e),e};