module.exports=function(){function e(r){return{}.toString.call(r).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function i(n){var s,o,i=t.dirname(r.realpathSync(n)),e={};try{s=r.readFileSync(n),o=JSON.parse(s),e=o.configuration||{},e.version=o.version}catch(a){console.log("node-options::readPackageconfig("+n+")|exception=",a)}return e.rootPath=i,e}function c(r){var n,t;r=r||{};for(n in r)t=n.toUpperCase(),"undefined"!==e(process.env[t])&&(r[n]=process.env[t]);return r}function u(e,t,a){var s,i=o(e,a);return i&&r.existsSync(i)?(s=JSON.parse(r.readFileSync(i)),t=n(s,t)):(e=t.rootPath+"/"+e,e&&r.existsSync(e)&&(s=JSON.parse(r.readFileSync(e)),t=n(s,t))),t}function o(e,o){if(!e||"/"===e.charAt(0))return e;var n=t.join(process.cwd(),e);return r.existsSync(n)?n:(n=t.join(process.env.HOME,o?o:"",e),r.existsSync(n)?n:e)}function n(r,n){for(var e in r)r.hasOwnProperty(e)&&(n[e]=r[e]);return n}function p(r){var o,t;r=n(r,{name:process.argv[1]}),o="USAGE: "+r.name;for(t in r)o+=" --"+t,"object"===e(r[t])||"array"===e(r[t])?o+="="+JSON.stringify(r[t]):"string"!==e(r[t])&&"number"!==e(r[t])||(o+="="+r[t]);return o}function a(r){var e='       UNKNOWN ARGUMENTS: "'+(r?r.join('", "'):"")+'"';return e}function l(i,r){var n=null,t=[],o=null;return i.forEach(function(a){var i,l;if(n)n.push(a);else if(o)o.push(a);else if("--"===a)o=[];else if(i=a.match(s),null!==i&&3===i.length&&void 0!==i[1]&&r.hasOwnProperty(i[1]))if(t.length>0)n=t,t=[];else if(void 0!==i[2])if(l=e(r[i[1]]),"object"===l||"array"===l)try{r[i[1]]=JSON.parse(i[2])}catch(c){n=[a+"* parse error"]}else r[i[1]]=i[2];else r[i[1]]=!r[i[1]];else t.push(a)}),{errors:n,args:t,end:o}}var t=require("path"),r=require("fs"),s=/^--(\s*[^=\s]+)(?:\s*=(.*))?$/;return{parse:l,mergeEnvironment:c,overlayConfig:u,readPackageConfig:i,usage:p,error:a,merge:n,isType:e}}();